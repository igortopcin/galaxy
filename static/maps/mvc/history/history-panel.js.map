{"version":3,"file":"history-panel.js","sources":["../../../src/mvc/history/history-panel.js"],"names":["define","LIST_PANEL","HISTORY_MODEL","HISTORY_CONTENTS","HDA_LI","HDCA_LI","COLLECTION_PANEL","USER","faIconButton","PopupMenu","BASE_MVC","_l","HistoryPrefs","SessionStorageModel","extend","defaults","expandedIds","show_deleted","show_hidden","addExpanded","model","key","this","save","_","get","object","id","removeExpanded","omit","toString","storageKeyPrefix","historyStorageKey","historyId","Error","clearAll","sessionStorage","indexOf","removeItem","_super","ModelListPanel","HistoryPanel","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","linkTarget","freeModel","clearUpdateTimeout","_setUpListeners","on","xhr","options","msg","details","errorHandler","views","length","trigger","loadHistoryWithDetails","historyFn","contentsFn","info","detailIdsFn","historyData","values","loadHistory","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","detailIds","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","storage","stopListening","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","multiselectActions","find","prepend","_renderSelectButton","title","classes","faIcon","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","contents","haveDetails","searchItems","$el","searchInput","fetchAllDetails","silent","done","error","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","currUser","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","remove","scrollToHid","hid","scrollToItem","first","viewsWhereModel","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}